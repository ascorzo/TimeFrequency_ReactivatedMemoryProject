function [dat_array, c_listSubj, v_subjKept] = ...
    f_skip_subject(dat_array, c_listSubj, subjgroups)

% dat_array         Data matrix containing subject values. Subject must be
%                   organized by column

% This function simply sets a skip value (1) to the current iteration going
% through the subjects

%% Set here the type of subjects you want to analyze
%  Do not be confused: The cell arrays will contain subjects to REJECT
%  Possible to reject multiple subject groups
%  'All'                = All subjects will be retained
%  'GL'                 = Only Good Learners will be retained
%  'BL'                 = Only Bad Learners will be retained
%  'XXX_Rec_vs_Test'    = Performance differences between pre-stimulation
%                         night testing vs post-simulation recall 
%  'XXX_DvsM'           = Difference in performance (Recall/Test) between
%                         TMR night D vs TMR night M
%  'XXXN'               = Only XXX Night will be retained
%  'Easy_Learning'      = Only one test run (pre night) needed to pass test
%  'Intensive_Learning' = Several attempts needed to pass test
% {'RC_051','RC_121','RC_131',...
%     'RC_141','RC_161','RC_171',...
%     'RC_201','RC_241','RC_251',...
%     'RC_261','RC_281','RC_291',...
%     'RC_301','RC_392','RC_412',...
%     'RC_442','RC_452','RC_462',...
%     'RC_472','RC_482','RC_492',...
%     'RC_512'}

if ischar(subjgroups)
    % We do it by number of elements below where each element is a subject
    % group.
    subjgroups = {subjgroups};
end

subjects2rej = {};
for i_grp = 1:numel(subjgroups)
   whatGrp = char(subjgroups(i_grp));
   switch whatGrp
       case 'All'
           % Nothing to do, no subject to reject
       case 'GL_DvsM'
           subjects2rej = [subjects2rej, {...
               'RC_091','RC_131','RC_141','RC_161','RC_171',...
               'RC_201','RC_261','RC_281','RC_291','RC_301',...
               'RC_392','RC_412','RC_442','RC_472','RC_482',...
               'RC_512','RC_092','RC_132','RC_142','RC_162',...
               'RC_172','RC_202','RC_262','RC_282','RC_292',...
               'RC_302','RC_391','RC_411','RC_441','RC_471',...
               'RC_481','RC_511'}];
       case 'BL_DvsM'
           subjects2rej = [subjects2rej, {...
               'RC_051','RC_121','RC_241','RC_251','RC_452',...
               'RC_462','RC_492','RC_052','RC_122','RC_242',...
               'RC_252','RC_451','RC_461','RC_491'}];
       case 'GL_DvsM_permissive'
           subjects2rej = [subjects2rej, {...
               'RC_091','RC_092',...
               'RC_131','RC_132',...
               'RC_141','RC_142',...
               'RC_161','RC_162',...
               'RC_201','RC_202',...
               'RC_261','RC_262',...
               'RC_281','RC_282',...
               'RC_301','RC_302',...
               'RC_472','RC_471',...
               'RC_482','RC_481'}];
       case 'BL_DvsM_permissive'
           subjects2rej = [subjects2rej, {...
               'RC_051','RC_052',...
               'RC_121','RC_122',...
               'RC_171','RC_172',...
               'RC_241','RC_242',...
               'RC_251','RC_252',...
               'RC_291','RC_292',...
               'RC_392','RC_391',...
               'RC_412','RC_411',...
               'RC_442','RC_441',...
               'RC_452','RC_451',...
               'RC_462','RC_461',...
               'RC_492','RC_491',...
               'RC_512','RC_511'}];
       case 'FN'
           subjects2rej = [subjects2rej, {...
               'RC_392',...
               'RC_412','RC_442','RC_452','RC_462','RC_472',...
               'RC_482','RC_492','RC_512'}];
       case 'SN'
           subjects2rej = [subjects2rej, {...
               'RC_051','RC_091','RC_121','RC_131','RC_141',...
               'RC_161','RC_171','RC_201','RC_241','RC_251',...
               'RC_261','RC_281','RC_291','RC_301'}];
       case 'GL_Rec_vs_Test'
           subjects2rej = [subjects2rej, {...
               'RC_091','RC_121','RC_131','RC_141','RC_171',...
               'RC_201','RC_281','RC_291','RC_301','RC_392',...
               'RC_442','RC_462','RC_472','RC_482'}];
       case 'BL_Rec_vs_Test'
           subjects2rej = [subjects2rej, {...
               'RC_051','RC_161','RC_241','RC_251','RC_261',...
               'RC_412','RC_452','RC_492','RC_512'}];
       case 'Intensive_Learning'
           subjects2rej = [subjects2rej, {...
               'RC_131','RC_141','RC_281','RC_301','RC_392',...
               'RC_412','RC_462','RC_482','RC_512'}];
       case 'Easy_Learning'
           subjects2rej = [subjects2rej, {...
               'RC_051','RC_091','RC_121','RC_161','RC_171',...
               'RC_201','RC_241','RC_251','RC_261','RC_291',...
               'RC_442','RC_452','RC_472','RC_492'}];
       case 'Less30'
           subjects2rej = [subjects2rej, {...
               }];
       otherwise
           error('Non valid subject type selection')
   end
    
end


subjects2rej        = unique(subjects2rej);
v_subjKept          = ~ismember(c_listSubj, subjects2rej);
dat_array           = dat_array(:, v_subjKept);
c_listSubj          = c_listSubj(v_subjKept);

end